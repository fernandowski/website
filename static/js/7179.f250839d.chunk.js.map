{"version":3,"file":"static/js/7179.f250839d.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/controllers/StreamController.js","../node_modules/@arcgis/core/views/3d/layers/graphics/StreamGraphics3DGraphicsPipeline.js","../node_modules/@arcgis/core/views/layers/StreamLayerView.js","../node_modules/@arcgis/core/views/3d/layers/StreamLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../geometry.js\";import t from\"../../../Graphic.js\";import s from\"../../../core/Accessor.js\";import{destroyMaybe as r}from\"../../../core/maybe.js\";import{EsriPromiseMixin as o}from\"../../../core/Promise.js\";import{watch as i}from\"../../../core/reactiveUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as n}from\"../../../core/accessorSupport/decorators/subclass.js\";import{StreamFeatureManager as c}from\"../data/StreamFeatureManager.js\";import{createConnection as h}from\"../sources/connections/createConnection.js\";import{EventedSet as d}from\"../../../views/3d/support/EventedSet.js\";import{featureGeometryTypeKebabDictionary as l}from\"../../../geometry/support/typeUtils.js\";const p=2500;let u=class extends t{constructor(e){super(e)}getObjectId(){return this.objectId}};e([a({type:Number,json:{read:!0}})],u.prototype,\"objectId\",void 0),u=e([n(\"esri.layers.graphics.controllers.StreamController.StreamGraphic\")],u);class m{constructor(e){this.onUpdate=e,this._idToGraphic=new Map}destroy(){this._idToGraphic.clear()}add(e){this._idToGraphic.set(e.objectId,e)}get(e){return this._idToGraphic.get(e)}forEach(e){this._idToGraphic.forEach(e)}removeById(e){const t=this._idToGraphic.get(e);return t?(t.sourceLayer=t.layer=null,this._idToGraphic.delete(e),t):null}update(e,t){this.onUpdate(e,t)}get size(){return this._idToGraphic.size}}let y=class extends(o(s)){constructor(){super(...arguments),this.isPaused=!1,this.graphics=new d,this._updateInfo={websocket:0,client:0},this._updateIntervalId=null,this._outSpatialReference=null}initialize(){this.addResolvingPromise(this.layer.when((()=>this._startup())))}destroy(){this.clear()}_clearInterval(){null!==this._updateIntervalId&&(clearInterval(this._updateIntervalId),this._updateIntervalId=null)}clear(){this._shutdown(),this.graphics.clear()}get updating(){return!this.connection||\"connected\"===this.connection.connectionStatus}_shutdown(){this._clearInterval(),this.connection=r(this.connection),this.store=r(this.store),this.removeAllHandles()}_startup(){const{layer:e,layerView:t}=this,{spatialReference:s,definitionExpression:r,geometryDefinition:o,objectIdField:a,timeInfo:n,purgeOptions:d,maxReconnectionAttempts:p,maxReconnectionInterval:u,customParameters:y}=e,f=e.geometryType?l.toJSON(e.geometryType):null,g=s,_=t.view.spatialReference;this.clear(),this._set(\"connection\",h(e.parsedUrl,g,_,f,r,o,p,u,y??void 0)),this._outSpatialReference=_.toJSON(),this.store=new m(this._onUpdate.bind(this)),this.featuresManager=new c(this.store,a,n.toJSON(),d);const I=\"startup-watches\";this.removeHandles(I),this.addHandles([e.on(\"send-message-to-socket\",(e=>this.connection.sendMessageToSocket(e))),e.on(\"send-message-to-client\",(e=>this.connection.sendMessageToClient(e))),this.connection.on(\"data-received\",(e=>this._onFeature(e))),this.connection.on(\"message-received\",(e=>this._onWebSocketMessage(e))),i((()=>[e.definitionExpression,e.geometryDefinition,e.purgeOptions]),(()=>this._startup()))],I),this.isPaused||this._initUpdateInterval()}_onWebSocketMessage(e){if(this.layerView.emit(\"message-received\",e),\"type\"in e)switch(e.type){case\"delete\":if(e.objectIds)for(const t of e.objectIds)this.featuresManager.removeById(t);if(e.trackIds)for(const t of e.trackIds)this.featuresManager.removeByTrackId(t);break;case\"clear\":this.store.forEach((e=>this.featuresManager.removeById(e.objectId)))}}_onFeature(e){this._updateInfo.websocket++,this.layerView.hasEventListener(\"data-received\")&&this.layerView.emit(\"data-received\",{attributes:e.attributes,centroid:e.centroid,geometry:e.geometry});try{null==e.geometry||e.geometry.spatialReference||(e.geometry.spatialReference=this._outSpatialReference);const t=u.fromJSON(e);t.sourceLayer=t.layer=this.layer,this.featuresManager.add(t)}catch{}}_onUpdate(e,t){null!=t&&this.graphics.removeMany(t),null!=e&&(this._updateInfo.client+=e.length,this.graphics.addMany(e))}_initUpdateInterval(){this._clearInterval();const{updateInterval:e}=this.layer;let t=performance.now();this._updateIntervalId=setInterval((()=>{const e=performance.now(),s=e-t;if(s>p){t=e;const r=Math.round(this._updateInfo.client/(s/1e3)),o=Math.round(this._updateInfo.websocket/(s/1e3));this._updateInfo.client=0,this._updateInfo.websocket=0,this.layerView.emit(\"update-rate\",{client:r,websocket:o})}this.featuresManager.checkForUpdates()}),e)}pauseStream(){this.isPaused=!0,this._clearInterval()}resumeStream(){this.isPaused=!1,this._initUpdateInterval()}disconnect(){this._shutdown()}connect(){null==this.connection&&this._startup()}clearGraphics(){this.graphics.clear()}};e([a()],y.prototype,\"isPaused\",void 0),e([a({constructOnly:!0})],y.prototype,\"layer\",void 0),e([a({constructOnly:!0})],y.prototype,\"layerView\",void 0),e([a()],y.prototype,\"connection\",void 0),e([a({readOnly:!0})],y.prototype,\"updating\",null),y=e([n(\"esri.layers.graphics.controllers.StreamController\")],y);export{y as StreamController,u as StreamGraphic};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import{property as e}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{StreamController as t}from\"../../../../layers/graphics/controllers/StreamController.js\";import{Graphics3DGraphicsPipeline as s}from\"./Graphics3DGraphicsPipeline.js\";let c=class extends s{constructor(r){super(r),this.suspendResumeExtentMode=\"computed\"}get connection(){return this.controller?.connection}createController(){return new t({layer:this.layer,layerView:this.layerView})}beforeSetController(){}pause(){this.controller?.pauseStream()}resume(){this.controller?.resumeStream()}disconnect(){this.controller?.disconnect()}connect(){this.controller?.connect()}clear(){this.controller?.clearGraphics()}};r([e()],c.prototype,\"controller\",void 0),r([e()],c.prototype,\"connection\",null),r([e()],c.prototype,\"suspendResumeExtentMode\",void 0),c=r([o(\"esri.views.3d.layers.graphics.StreamGraphics3DGraphicsPipeline\")],c);export{c as StreamGraphics3DGraphicsPipeline};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../../chunks/tslib.es6.js\";import{property as e}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../layers/support/FeatureFilter.js\";const r=r=>{let i=class extends r{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}disconnect(){this._doDisconnect()}connect(){this._doConnect()}clear(){this._doClear()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return(this._isUserPaused||this.suspended)&&\"connected\"===this._streamConnectionStatus?\"paused\":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return s([e()],i.prototype,\"_isUserPaused\",void 0),s([e({readOnly:!0})],i.prototype,\"connectionStatus\",null),s([e({type:o})],i.prototype,\"filter\",void 0),i=s([t(\"esri.views.layers.StreamLayerView\")],i),i};export{r as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Error.js\";import{watch as t}from\"../../../core/reactiveUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import{StreamController as s}from\"../../../layers/graphics/controllers/StreamController.js\";import n from\"../../../rest/support/Query.js\";import{FeatureLikeLayerView3D as a}from\"./FeatureLikeLayerView3D.js\";import{LayerView3D as p}from\"./LayerView3D.js\";import{StreamGraphics3DGraphicsPipeline as c}from\"./graphics/StreamGraphics3DGraphicsPipeline.js\";import{UpdatePolicy as l}from\"../webgl-engine/lib/UpdatePolicy.js\";import h from\"../../layers/LayerView.js\";import m from\"../../layers/StreamLayerView.js\";let u=class extends(m(a(p(h)))){constructor(){super(...arguments),this.type=\"stream-3d\",this.updatePolicy=l.ASYNC,this.hasZ=!0,this.hasM=!1}initialize(){this.addHandles(t((()=>this.suspended),(e=>{this.graphicsPipeline&&this._onSuspendedChange(e)})))}get connectionError(){const e=this.graphicsPipeline?.connection?.errorString;return e?new r(\"stream-controller\",e):null}createQuery(){return new n({outFields:[\"*\"],returnGeometry:!0,outSpatialReference:this.view.spatialReference})}queryLatestObservations(e,r){return this.queryEngine.executeQueryForLatestObservations(this._ensureQuery(e),r?.signal)}get _streamConnectionStatus(){return this.graphicsPipeline?.connection?.connectionStatus??\"disconnected\"}createGraphicsPipeline(){return new c({layerView:this})}createController(){return new s({layer:this.layer,layerView:this})}beforeSetController(){}_doPause(){this.graphicsPipeline?.pause()}_doResume(){this.graphicsPipeline?.resume()}_doDisconnect(){this.graphicsPipeline?.disconnect(),this._doPause()}_doConnect(){this.graphicsPipeline?.connect(),this.resume()}_doClear(){this.graphicsPipeline?.clear()}};e([i({readOnly:!0})],u.prototype,\"updatePolicy\",void 0),e([i({readOnly:!0})],u.prototype,\"connectionError\",null),e([i()],u.prototype,\"graphicsPipeline\",void 0),e([i({readOnly:!0})],u.prototype,\"hasZ\",void 0),e([i({readOnly:!0})],u.prototype,\"hasM\",void 0),e([i({readOnly:!0})],u.prototype,\"_streamConnectionStatus\",null),u=e([o(\"esri.views.3d.layers.StreamLayerView3D\")],u);const d=u;export{d as default};\n"],"names":["u","t","constructor","e","super","getObjectId","this","objectId","a","type","Number","json","read","prototype","n","m","onUpdate","_idToGraphic","Map","destroy","clear","add","set","get","forEach","removeById","sourceLayer","layer","delete","update","size","y","o","s","arguments","isPaused","graphics","d","_updateInfo","websocket","client","_updateIntervalId","_outSpatialReference","initialize","addResolvingPromise","when","_startup","_clearInterval","clearInterval","_shutdown","updating","connection","connectionStatus","r","store","removeAllHandles","layerView","spatialReference","definitionExpression","geometryDefinition","objectIdField","timeInfo","purgeOptions","maxReconnectionAttempts","p","maxReconnectionInterval","customParameters","f","geometryType","l","toJSON","g","_","view","_set","h","parsedUrl","_onUpdate","bind","featuresManager","c","I","removeHandles","addHandles","on","sendMessageToSocket","sendMessageToClient","_onFeature","_onWebSocketMessage","i","_initUpdateInterval","emit","objectIds","trackIds","removeByTrackId","hasEventListener","attributes","centroid","geometry","fromJSON","removeMany","length","addMany","updateInterval","performance","now","setInterval","Math","round","checkForUpdates","pauseStream","resumeStream","disconnect","connect","clearGraphics","constructOnly","readOnly","suspendResumeExtentMode","controller","createController","beforeSetController","pause","resume","_isUserPaused","suspended","_doResume","_doPause","_doDisconnect","_doConnect","_doClear","filter","_streamConnectionStatus","_onSuspendedChange","updatePolicy","ASYNC","hasZ","hasM","graphicsPipeline","connectionError","errorString","createQuery","outFields","returnGeometry","outSpatialReference","queryLatestObservations","queryEngine","executeQueryForLatestObservations","_ensureQuery","signal","createGraphicsPipeline"],"sourceRoot":""}